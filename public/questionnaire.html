<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weekly Planning ‚Äì Your Operating System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Cormorant+Garamond:ital,wght@0,400;1,600&family=JetBrains+Mono:wght@300;400&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">


  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      background: #ffffff;
      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
      color: #000000;
      overflow: hidden;
    }

    /* Bigger Picture Experience Container */
    .bigger-picture-experience {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 10000;
      background: #ffffff;
    }

    .bp-step {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.8s ease;
    }

    .bp-step.active {
      opacity: 1;
      pointer-events: all;
    }
    

/* Week Items */
.week-item {
  padding: 12px 20px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.8rem;
  color: rgba(0,0,0,0.6);
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 400;
}

.week-item.active {
  background: rgba(0,0,0,0.05);
  font-weight: 500;
  color: #000000;
}

.week-item:hover {
  background: rgba(0,0,0,0.02);
}

/* Main Content */
.main-content {
  margin-left: 50px;
  transition: margin-left 0.3s ease;
}


    /* Step 1: Vision Splash - Cinematic Carousel */
    /* Vision Collage ‚Äî Full Screen */
    
/* Vision Collage Styles - Full Screen */
    /* ============================================ */
/* UPDATED VISION BOARD STYLES */
/* Copy this into your <style> section */
/* ============================================ */

/* Pre-loading Screen with Pink Halo */
.vision-pre-loading {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000000;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  opacity: 1;
  transition: opacity 1s ease;
}

.vision-pre-loading.hidden {
  opacity: 0;
  pointer-events: none;
}

.vision-pre-content {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.vision-pre-text {
  position: relative;
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
  font-size: 3rem;
  font-weight: 300;
  letter-spacing: -1px;
  color: #ffffff;
  text-align: center;
  z-index: 2;
  padding: 0 40px;
}

.vision-pre-halo {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 500px;
  height: 500px;
  border-radius: 50%;
  background: radial-gradient(circle at center, 
    rgba(255, 20, 147, 0.4) 0%,
    rgba(255, 105, 180, 0.2) 30%,
    rgba(255, 20, 147, 0.1) 50%,
    transparent 70%
  );
  filter: blur(40px);
  animation: haloGlowPulse 3s ease-in-out infinite;
  pointer-events: none;
  z-index: 1;
}

@keyframes haloGlowPulse {
  0%, 100% { 
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.8;
  }
  50% { 
    transform: translate(-50%, -50%) scale(1.15);
    opacity: 1;
  }
}

/* Vision Collage Container */
.vision-collage-container {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  background: #000000;
}

.vision-collage {
  display: grid;
  height: 100%;
  width: 100%;
  padding: 30px;
  gap: 20px;
  grid-template-columns: repeat(5, 1fr);
  grid-template-rows: repeat(3, 1fr);
}

/* Images with Floating Animation */
.collage-img {
  width: 100%;
  height: 100%;
  border-radius: 12px;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
  opacity: 0;
  transform: scale(0.85) translateY(30px);
  transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.collage-img.loaded {
  opacity: 1;
  transform: scale(1) translateY(0);
  animation: gentleFloat 6s ease-in-out infinite;
}

/* Stagger floating animations */
.collage-img:nth-child(1).loaded { animation-delay: 0s; }
.collage-img:nth-child(2).loaded { animation-delay: 0.5s; }
.collage-img:nth-child(3).loaded { animation-delay: 1s; }
.collage-img:nth-child(4).loaded { animation-delay: 1.5s; }
.collage-img:nth-child(5).loaded { animation-delay: 2s; }
.collage-img:nth-child(6).loaded { animation-delay: 2.5s; }
.collage-img:nth-child(7).loaded { animation-delay: 3s; }
.collage-img:nth-child(8).loaded { animation-delay: 3.5s; }
/* Beyond 8 images - continue pattern */
.collage-img:nth-child(n+9).loaded { animation-delay: 4s; }

@keyframes gentleFloat {
  0%, 100% { 
    transform: scale(1) translateY(0) translateX(0);
  }
  25% { 
    transform: scale(1.01) translateY(-8px) translateX(3px);
  }
  50% { 
    transform: scale(0.99) translateY(-5px) translateX(-2px);
  }
  75% { 
    transform: scale(1.01) translateY(-10px) translateX(2px);
  }
}

/* Grid Layout - Works for any number of images */
.collage-img:nth-child(1) { grid-column: span 2; grid-row: span 2; }
.collage-img:nth-child(2) { grid-column: span 1; grid-row: span 1; }
.collage-img:nth-child(3) { grid-column: span 2; grid-row: span 1; }
.collage-img:nth-child(4) { grid-column: span 1; grid-row: span 2; }
.collage-img:nth-child(5) { grid-column: span 1; grid-row: span 1; }
.collage-img:nth-child(6) { grid-column: span 1; grid-row: span 1; }
.collage-img:nth-child(7) { grid-column: span 2; grid-row: span 1; }
.collage-img:nth-child(8) { grid-column: span 2; grid-row: span 1; }
/* Images 9+ will automatically flow into grid */

/* Overlay - Bottom Right Position */
.vision-overlay {
  position: absolute;
  bottom: 40px;
  right: 40px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  z-index: 10;
  opacity: 0;
  transition: opacity 1s ease 0.5s;
}

.vision-overlay.visible {
  opacity: 1;
}

.vision-date {
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
  font-size: 0.85rem;
  color: rgba(255, 255, 255, 0.7);
  margin-bottom: 15px;
  text-shadow: 0 2px 8px rgba(0,0,0,0.6);
  font-weight: 400;
  letter-spacing: 0.5px;
  text-align: right;
}

.vision-continue-btn {
  background: rgba(255, 255, 255, 0.95);
  color: black;
  border: none;
  padding: 16px 40px;
  font-size: 0.8rem;
  letter-spacing: 1.5px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
  text-transform: uppercase;
  font-weight: 500;
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.vision-continue-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
  background: #ffffff;
}

/* Responsive */
@media (max-width: 968px) {
  .vision-collage {
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(4, 1fr);
    padding: 20px;
    gap: 15px;
  }
  
  .collage-img:nth-child(1),
  .collage-img:nth-child(2),
  .collage-img:nth-child(3),
  .collage-img:nth-child(4),
  .collage-img:nth-child(5),
  .collage-img:nth-child(6),
  .collage-img:nth-child(7),
  .collage-img:nth-child(8) {
    grid-column: span 1;
    grid-row: span 1;
  }
  
  .vision-overlay {
    bottom: 30px;
    right: 20px;
  }
  
  .vision-pre-text {
    font-size: 2rem;
    padding: 0 30px;
  }
  
  .vision-pre-halo {
    width: 350px;
    height: 350px;
  }
}

/* ============================================ */
/* UPDATED: Flexible Grid + Sleeker Checkmark */
/* Replace your milestones CSS with this */
/* ============================================ */

/* Pre-loading Screen - BLACK BACKGROUND like vision board */
.milestones-pre-loading {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #000000;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
  opacity: 1;
  transition: opacity 1s ease;
}

.milestones-pre-loading.hidden {
  opacity: 0;
  pointer-events: none;
}

.milestones-pre-content {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.milestones-pre-text {
  position: relative;
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
  font-size: 3rem;
  font-weight: 300;
  letter-spacing: -1px;
  color: #ffffff;
  text-align: center;
  z-index: 2;
  padding: 0 40px;
}

.milestones-pre-halo {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 500px;
  height: 500px;
  border-radius: 50%;
  background: radial-gradient(circle at center, 
    rgba(255, 20, 147, 0.4) 0%,
    rgba(255, 105, 180, 0.2) 30%,
    rgba(255, 20, 147, 0.1) 50%,
    transparent 70%
  );
  filter: blur(40px);
  animation: haloGlowPulse 3s ease-in-out infinite;
  pointer-events: none;
  z-index: 1;
}

/* Milestones Collage Container - EXACT SAME AS VISION */
.milestones-collage-container {
  position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  background: #000000;
}

.milestones-collage {
  display: grid;
  height: 100%;
  width: 100%;
  padding: 30px;
  gap: 20px;
  grid-template-columns: repeat(5, 1fr);
  grid-auto-rows: minmax(150px, 1fr);  /* Auto rows for overflow */
  overflow-y: auto;  /* Allow scrolling if needed */
}

/* Milestone Items - Images with Floating Animation */
.milestone-img {
  width: 100%;
  height: 100%;
  min-height: 200px;
  border-radius: 12px;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
  opacity: 0;
  transform: scale(0.85) translateY(30px);
  transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  cursor: pointer;
}

.milestone-img.loaded {
  opacity: 1;
  transform: scale(1) translateY(0);
  animation: gentleFloat 6s ease-in-out infinite;
}

/* Stagger floating animations */
.milestone-img:nth-child(1).loaded { animation-delay: 0s; }
.milestone-img:nth-child(2).loaded { animation-delay: 0.5s; }
.milestone-img:nth-child(3).loaded { animation-delay: 1s; }
.milestone-img:nth-child(4).loaded { animation-delay: 1.5s; }
.milestone-img:nth-child(5).loaded { animation-delay: 2s; }
.milestone-img:nth-child(6).loaded { animation-delay: 2.5s; }
.milestone-img:nth-child(7).loaded { animation-delay: 3s; }
.milestone-img:nth-child(8).loaded { animation-delay: 3.5s; }
.milestone-img:nth-child(9).loaded { animation-delay: 4s; }
.milestone-img:nth-child(10).loaded { animation-delay: 4.5s; }
.milestone-img:nth-child(11).loaded { animation-delay: 5s; }
.milestone-img:nth-child(12).loaded { animation-delay: 5.5s; }
.milestone-img:nth-child(13).loaded { animation-delay: 6s; }
.milestone-img:nth-child(14).loaded { animation-delay: 6.5s; }
.milestone-img:nth-child(15).loaded { animation-delay: 7s; }

/* Grid Layout - First 8 get special sizes, rest flow naturally */
.milestone-img:nth-child(1) { grid-column: span 2; grid-row: span 2; }
.milestone-img:nth-child(2) { grid-column: span 1; grid-row: span 1; }
.milestone-img:nth-child(3) { grid-column: span 2; grid-row: span 1; }
.milestone-img:nth-child(4) { grid-column: span 1; grid-row: span 2; }
.milestone-img:nth-child(5) { grid-column: span 1; grid-row: span 1; }
.milestone-img:nth-child(6) { grid-column: span 1; grid-row: span 1; }
.milestone-img:nth-child(7) { grid-column: span 2; grid-row: span 1; }
.milestone-img:nth-child(8) { grid-column: span 2; grid-row: span 1; }
/* Items 9-15 automatically flow into remaining grid cells */
.milestone-img:nth-child(n+9) { 
  grid-column: span 1; 
  grid-row: span 1; 
}

/* Text Overlay on Each Image */
.milestone-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  padding: 20px;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.7) 50%, transparent 100%);
  display: flex;
  align-items: center;
  gap: 12px;
}

.milestone-checkbox {
  width: 24px;
  height: 24px;
  cursor: pointer;
  accent-color: #ffffff;
  flex-shrink: 0;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
}

.milestone-label {
  flex: 1;
  font-size: 0.95rem;
  color: #ffffff;
  font-weight: 500;
  line-height: 1.4;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
}

/* Completed State - Sleeker Minimal Checkmark */
.milestone-img.completed {
  filter: saturate(0.2) brightness(0.6);
}

.milestone-img.completed::before {
  content: '‚úì';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 6rem;
  font-weight: 200;
  color: rgba(255, 255, 255, 0.95);
  z-index: 2;
  text-shadow: 0 0 40px rgba(255, 255, 255, 0.5),
               0 0 80px rgba(255, 255, 255, 0.3);
  pointer-events: none;
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Arial', sans-serif;
  letter-spacing: -5px;
}

/* Subtle glow animation on completed checkmark */
@keyframes checkGlow {
  0%, 100% { 
    text-shadow: 0 0 40px rgba(255, 255, 255, 0.5),
                 0 0 80px rgba(255, 255, 255, 0.3);
    transform: translate(-50%, -50%) scale(1);
  }
  50% { 
    text-shadow: 0 0 50px rgba(255, 255, 255, 0.7),
                 0 0 100px rgba(255, 255, 255, 0.5);
    transform: translate(-50%, -50%) scale(1.02);
  }
}

.milestone-img.completed::before {
  animation: checkGlow 3s ease-in-out infinite;
}

/* Bottom Right Overlay - Button */
.milestones-bottom-overlay {
  position: absolute;
  bottom: 40px;
  right: 40px;
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  z-index: 10;
  opacity: 0;
  transition: opacity 1s ease 0.5s;
}

.milestones-bottom-overlay.visible {
  opacity: 1;
}

.milestone-continue-btn {
  background: rgba(255, 255, 255, 0.95);
  color: #000000;
  border: none;
  padding: 16px 40px;
  font-size: 0.8rem;
  letter-spacing: 1.5px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
  text-transform: uppercase;
  font-weight: 500;
  font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.milestone-continue-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
  background: #ffffff;
}

/* Responsive */
@media (max-width: 968px) {
  .milestones-collage {
    grid-template-columns: repeat(2, 1fr);
    padding: 20px;
    gap: 15px;
  }
  
  .milestone-img:nth-child(1),
  .milestone-img:nth-child(2),
  .milestone-img:nth-child(3),
  .milestone-img:nth-child(4),
  .milestone-img:nth-child(5),
  .milestone-img:nth-child(6),
  .milestone-img:nth-child(7),
  .milestone-img:nth-child(8),
  .milestone-img:nth-child(n+9) {
    grid-column: span 1;
    grid-row: span 1;
  }
  
  .milestones-bottom-overlay {
    bottom: 30px;
    right: 20px;
  }
  
  .milestones-pre-text {
    font-size: 2rem;
    padding: 0 30px;
  }
  
  .milestones-pre-halo {
    width: 350px;
    height: 350px;
  }
  
  .milestone-img.completed::before {
    font-size: 4rem;
  }
}

    /* Step 3: Sprint Focus */
    .sprint-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 60px;
      height: 100%;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      background: #ffffff;
    }

    .sprint-header {
      text-align: center;
      margin-bottom: 60px;
    }

    .sprint-badge {
      display: inline-block;
      padding: 8px 20px;
      background: #000000;
      color: #ffffff;
      font-size: 0.7rem;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 20px;
      border-radius: 4px;
    }

    .sprint-title {
      font-size: 2.5rem;
      font-weight: 300;
      margin-bottom: 15px;
      letter-spacing: -1px;
      line-height: 1.3;
      color: #000000;
    }

    .sprint-dates {
      font-size: 0.95rem;
      color: rgba(0, 0, 0, 0.4);
      letter-spacing: 0.5px;
    }

    .sprint-body {
      flex: 1;
      margin-bottom: 40px;
    }

    .sprint-section {
      margin-bottom: 50px;
    }

    .sprint-section-title {
      font-size: 1.3rem;
      font-weight: 500;
      margin-bottom: 25px;
      color: #000000;
    }

    .sprint-milestones {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .sprint-milestone {
      display: flex;
      align-items: flex-start;
      padding: 20px 25px;
      background: #fafafa;
      border-left: 3px solid #000000;
      transition: all 0.3s;
      border-radius: 4px;
    }

    .sprint-milestone:hover {
      background: #f5f5f5;
      transform: translateX(5px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .milestone-number {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #000000;
      color: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-right: 20px;
      flex-shrink: 0;
      font-size: 0.9rem;
    }

    .milestone-text {
      flex: 1;
      font-size: 1rem;
      line-height: 1.6;
      color: rgba(0, 0, 0, 0.8);
      padding-top: 8px;
    }

    .commitment-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
    }

    .commitment-card {
      padding: 25px;
      background: #fafafa;
      border: 1px solid rgba(0, 0, 0, 0.08);
      transition: all 0.3s;
      border-radius: 8px;
    }

    .commitment-card:hover {
      background: #f5f5f5;
      border-color: rgba(0, 0, 0, 0.15);
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    }

    .commitment-icon {
      font-size: 2rem;
      margin-bottom: 15px;
    }

    .commitment-title {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 15px;
      color: #000000;
    }

    .commitment-details {
      font-size: 0.9rem;
      color: rgba(0, 0, 0, 0.6);
      line-height: 1.8;
    }

    .sprint-philosophy {
      display: flex;
      align-items: flex-start;
      padding: 30px;
      background: linear-gradient(135deg, rgba(0, 0, 0, 0.03), rgba(0, 0, 0, 0.01));
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
    }

    .philosophy-icon {
      font-size: 2rem;
      margin-right: 20px;
      flex-shrink: 0;
    }

    .philosophy-text {
      flex: 1;
      font-size: 1.05rem;
      line-height: 1.8;
      color: rgba(0, 0, 0, 0.7);
      font-style: italic;
    }

    .sprint-begin-btn {
      background: #000000;
      color: #ffffff;
      border: none;
      padding: 20px 60px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
      margin: 0 auto;
      display: block;
      border-radius: 4px;
    }

    .sprint-begin-btn:hover {
      background: #1a1a1a;
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Navigation Sidebar */
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 260px;
  height: 100%;
  background: white;
  border-right: 1px solid #ddd;
  transform: translateX(-260px);
  transition: transform 0.3s ease;
  z-index: 1000;
}

.sidebar.expanded {
  transform: translateX(0);
}

.sidebar.collapsed {
  pointer-events: auto;
  transform: translateX(-260px);
  background: transparent;
  border-right: none;
  box-shadow: none;
}

/* Toggle Button */
.sidebar-toggle {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1100;
  background: black;
  color: white;
  font-size: 18px;
  border: none;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
}

.sidebar-toggle:hover {
  background: rgba(0,0,0,0.08);
  transform: scale(1.05);
}

/* Content inside sidebar */
.sidebar-content {
  margin-top: 70px;
  padding: 20px;
}

.sidebar-section-top {
  padding: 10px 0 20px;
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.sidebar-section {
  padding: 20px 0;
}

.sidebar-header {
  padding: 10px 20px;
  font-size: 0.65rem;
  font-weight: 600;
  color: rgba(0,0,0,0.3);
  text-transform: uppercase;
  letter-spacing: 1.2px;
}

.sidebar-item {
  padding: 12px 20px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.9rem;
  color: rgba(0,0,0,0.7);
  display: flex;
  align-items: center;
  gap: 12px;
  border-left: 3px solid transparent;
}

.sidebar-item.active {
  background: rgba(0,0,0,0.04);
  font-weight: 500;
  color: #000;
  border-left-color: #000;
}

.week-item {
  padding: 12px 20px;
  cursor: pointer;
  transition: all 0.2s;
  font-size: 0.85rem;
  color: rgba(0,0,0,0.7);
}

.week-item:hover {
  background: rgba(0,0,0,0.04);
}




    /* Main Container */
    .main-container {
      max-width: 1400px; margin: 0 auto; padding: 40px 60px;
      min-height: 100vh; display: flex; flex-direction: column;
      background: #ffffff;
    }

    /* Header */
    .header { margin-bottom: 60px; }
    .progress-bar { display: flex; gap: 8px; margin-bottom: 20px; }
    .progress-section {
      flex: 1; height: 3px; background: rgba(0, 0, 0, 0.08); transition: all 0.3s;
    }
    .progress-section.completed { background: #000000; }
    .progress-section.current { background: rgba(0, 0, 0, 0.3); }
    .progress-label {
      display: flex; justify-content: space-between; font-size: 0.75rem;
      color: rgba(0, 0, 0, 0.5); text-transform: uppercase;
      letter-spacing: 1.5px; font-weight: 500;
    }

    /* Two Column */
    .content-wrapper {
      display: grid; grid-template-columns: 280px 1fr; gap: 60px; flex: 1;
    }


    /* Content Area */
    .content-area { max-width: 800px; }
    .section { margin-bottom: 80px; animation: fadeIn 0.5s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    
    .section-header { margin-bottom: 40px; }
    .section-title {
      font-size: 2rem; font-weight: 300; margin-bottom: 8px; letter-spacing: -1px;
      color: #000000;
    }
    .section-subtitle {
      font-size: 0.85rem; color: rgba(0, 0, 0, 0.5); font-weight: 300;
    }

    /* Questions */
    .question-block { margin-bottom: 40px; }
    .question-label {
      font-size: 0.95rem; margin-bottom: 8px; font-weight: 500;
      color: #000000;
    }
    .question-sublabel {
      font-size: 0.8rem; color: rgba(0, 0, 0, 0.4);
      margin-bottom: 12px; font-weight: 300;
    }

    /* Inputs */
    .input-field {
      width: 100%; background: transparent; border: none;
      border-bottom: 1px solid rgba(0, 0, 0, 0.12); padding: 12px 0;
      font-size: 1rem; color: #000000; transition: all 0.25s;
      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif; font-weight: 400;
    }
    .input-field:focus {
      outline: none; border-bottom-color: #000000;
    }
    textarea.input-field {
      min-height: 100px; line-height: 1.6; resize: vertical; padding-top: 8px;
    }

    /* Celebration */
    .celebration-banner {
      padding: 20px 30px;
      background: #fafafa;
      border: 1px solid rgba(0, 0, 0, 0.1); text-align: center;
      font-size: 1.1rem; color: #000000; font-weight: 400;
      margin-bottom: 40px; letter-spacing: 0.5px;
      border-radius: 4px;
    }

    /* Goals */
    .goal-list { margin-top: 15px; }
    .goal-item {
      display: flex; align-items: center; padding: 15px 20px; margin-bottom: 10px;
      background: #fafafa; border: 1px solid rgba(0, 0, 0, 0.08);
      cursor: pointer; transition: all 0.3s;
      border-radius: 4px;
    }
    .goal-item:hover {
      background: #f5f5f5; border-color: rgba(0, 0, 0, 0.15);
    }
    .goal-item.completed {
      background: #f0f0f0; border-color: rgba(0, 0, 0, 0.2);
    }
    .goal-checkbox {
      width: 20px; height: 20px; margin-right: 15px; cursor: pointer; accent-color: #000000;
    }
    .goal-text {
      flex: 1; font-size: 0.95rem; color: #000000; font-weight: 400;
    }
    .goal-item.completed .goal-text {
      color: rgba(0, 0, 0, 0.4); text-decoration: line-through;
    }
    .goal-celebration {
      font-size: 1.2rem; opacity: 0; transition: opacity 0.3s;
    }
    .goal-item.completed .goal-celebration {
      opacity: 1; animation: celebrate 0.6s ease;
    }
    @keyframes celebrate {
      0% { transform: scale(0) rotate(0deg); }
      50% { transform: scale(1.3) rotate(180deg); }
      100% { transform: scale(1) rotate(360deg); }
    }

    /* Toggles */
    .toggle-group { display: flex; gap: 12px; margin-top: 12px; }
    .toggle-btn {
      flex: 1; padding: 14px 20px; border: 1px solid rgba(0, 0, 0, 0.12);
      background: transparent; color: rgba(0, 0, 0, 0.6); cursor: pointer;
      transition: all 0.3s; font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif; 
      font-size: 0.9rem; border-radius: 4px;
    }
    .toggle-btn:hover { border-color: rgba(0, 0, 0, 0.25); }
    .toggle-btn.good.active {
      border-color: #000000; background: rgba(0, 0, 0, 0.05); color: #000000;
    }
    .toggle-btn.bad.active {
      border-color: #ff6464; background: rgba(255, 100, 100, 0.05); color: #ff6464;
    }
    .action-input-wrapper { margin-top: 15px; display: none; }
    .action-input-wrapper.visible { display: block; animation: fadeIn 0.3s; }

    /* Radio */
    .radio-group { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px; }
    .radio-label {
      padding: 10px 20px; border: 1px solid rgba(0, 0, 0, 0.12);
      cursor: pointer; transition: all 0.3s; color: rgba(0, 0, 0, 0.6);
      font-size: 0.9rem; border-radius: 20px;
    }
    .radio-label:hover {
      border-color: rgba(0, 0, 0, 0.25); color: #000000;
    }
    input[type="radio"] { display: none; }
    input[type="radio"]:checked + .radio-label {
      border-color: #000000; background: rgba(0, 0, 0, 0.05); color: #000000;
    }

    /* Checkboxes */
    .checkbox-group { margin-top: 12px; }
    .checkbox-item {
      display: flex; align-items: center; margin-bottom: 10px; padding: 12px 15px;
      border: 1px solid rgba(0, 0, 0, 0.08); cursor: pointer; transition: all 0.3s;
      border-radius: 4px; background: #fafafa;
    }
    .checkbox-item:hover {
      background: #f5f5f5; border-color: rgba(0, 0, 0, 0.15);
    }
    .checkbox-item input[type="checkbox"] {
      margin-right: 12px; width: 18px; height: 18px; cursor: pointer; accent-color: #000000;
    }
    .checkbox-label {
      flex: 1; font-size: 0.9rem; color: #000000; font-weight: 400;
    }

    /* Slider */
    .slider-wrapper { margin-top: 20px; }
    .slider {
      width: 100%; -webkit-appearance: none; background: rgba(0, 0, 0, 0.1);
      height: 4px; outline: none; border-radius: 2px;
    }
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none; height: 18px; width: 18px; border-radius: 50%;
      background: #000000; cursor: pointer; transition: 0.2s;
    }
    .slider::-moz-range-thumb {
      height: 18px; width: 18px; border-radius: 50%; background: #000000;
      cursor: pointer; border: none;
    }
    .slider-value {
      text-align: center; margin-top: 12px; font-size: 1.8rem;
      color: #000000; font-weight: 300;
    }

    /* KPIs */
    .kpi-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px; margin-top: 20px;
    }
    .kpi-item {
      padding: 20px; background: #fafafa;
      border: 1px solid rgba(0, 0, 0, 0.08);
      border-radius: 4px;
    }
    .kpi-label {
      font-size: 0.75rem; color: rgba(0, 0, 0, 0.5); margin-bottom: 10px;
      text-transform: uppercase; letter-spacing: 1px; font-weight: 500;
    }
    .kpi-input {
      width: 100%; background: transparent; border: none;
      border-bottom: 1px solid rgba(0, 0, 0, 0.15); padding: 8px 0;
      font-size: 1.4rem; color: #000000;
      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
      font-weight: 300;
    }
    .kpi-input:focus {
      outline: none; border-bottom-color: #000000;
    }

    /* Context */
    .context-box {
      padding: 25px; background: #fafafa;
      border: 1px solid rgba(0, 0, 0, 0.08); margin-bottom: 40px;
      border-radius: 4px;
    }
    .context-section { margin-bottom: 25px; }
    .context-section:last-child { margin-bottom: 0; }
    .context-title {
      font-size: 0.75rem; color: #000000; text-transform: uppercase;
      letter-spacing: 1px; margin-bottom: 12px; font-weight: 600;
    }
    .context-item {
      padding: 12px 15px; margin-bottom: 8px; background: #ffffff;
      border-left: 2px solid rgba(0, 0, 0, 0.2); font-size: 0.9rem;
      line-height: 1.5; color: rgba(0, 0, 0, 0.8);
      border-radius: 2px;
    }

    /* Goal Summary */
    .goal-summary {
      padding: 40px; background: #fafafa;
      border: 1px solid rgba(0, 0, 0, 0.1); margin-bottom: 40px;
      border-radius: 8px;
    }
    .goal-summary-title {
      font-size: 1.5rem; color: #000000; margin-bottom: 30px;
      text-align: center; font-weight: 300; letter-spacing: -0.5px;
    }
    .goal-category { margin-bottom: 25px; }
    .goal-category-title {
      font-size: 0.85rem; color: rgba(0, 0, 0, 0.6); margin-bottom: 12px;
      font-weight: 500; text-transform: uppercase; letter-spacing: 1px;
    }
    .goal-display-item {
      padding: 12px 15px; margin-bottom: 8px; background: #ffffff;
      border-left: 2px solid #000000; font-size: 0.95rem;
      color: #000000; font-weight: 400;
      border-radius: 2px;
    }

    /* Pause */
    .pause-card {
      padding: 25px 30px; background: #fafafa;
      border-left: 3px solid #000000; margin: 40px 0; font-style: italic;
      color: rgba(0, 0, 0, 0.7); line-height: 1.6;
      border-radius: 2px;
    }

    /* Threshold Alerts */
    .threshold-alert {
      margin-top: 15px; padding: 15px 20px; background: rgba(255, 100, 100, 0.05);
      border-left: 3px solid #ff6464; font-size: 0.9rem; color: rgba(0, 0, 0, 0.8);
      border-radius: 2px;
    }

    /* Navigation */
    .nav-footer {
      display: flex; justify-content: flex-end; gap: 15px; margin-top: 60px;
      padding-top: 40px; border-top: 1px solid rgba(0, 0, 0, 0.08);
    }
    .nav-btn {
      padding: 14px 32px; font-size: 0.85rem; cursor: pointer;
      background: transparent; border: 1px solid rgba(0, 0, 0, 0.15);
      color: rgba(0, 0, 0, 0.7); transition: all 0.2s;
      letter-spacing: 1px; text-transform: uppercase; 
      font-family: -apple-system, BlinkMacSystemFont, 'Helvetica', 'Arial', sans-serif;
      border-radius: 4px;
    }
    .nav-btn:hover {
      border-color: rgba(0, 0, 0, 0.3); color: #000000;
    }
    .nav-btn-primary {
      background: #000000; color: #ffffff; border: none;
    }
    .nav-btn-primary:hover {
      background: #1a1a1a;
      transform: translateY(-2px);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .content-wrapper { grid-template-columns: 1fr; gap: 40px; }
      .section-nav { flex-direction: row; flex-wrap: wrap; }
      .recommended-actions { margin-top: 20px; }
      .milestones-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
      .commitment-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 768px) {
      .main-container { padding: 30px 20px; }
      .kpi-grid { grid-template-columns: 1fr; }
      .vision-title { font-size: 2.5rem; }
      .vision-subtitle { font-size: 1.1rem; }
      .vision-image-container {
        width: 90vw;
        height: 90vw;
        max-width: 500px;
        max-height: 500px;
      }
      .vision-content { padding: 40px 30px; }
      .milestones-container { padding: 60px 30px; }
      .milestones-title { font-size: 2rem; }
      .milestones-grid { grid-template-columns: 1fr; }
      .sprint-container { padding: 40px 30px; }
      .sprint-title { font-size: 1.8rem; }
      .celebration-icon { font-size: 5rem; }
      .celebration-message { font-size: 2rem; }
      .celebration-quote { font-size: 1.1rem; }
    }
  </style>
</head>

<body>

  <!-- Sidebar Toggle Button -->
<button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>

<!-- Navigation Sidebar -->
<div id="sidebar" class="sidebar collapsed">
  <div class="sidebar-content">

    <!-- Current Week -->
    <div class="sidebar-section-top">
      <div class="sidebar-header">Current Week</div>
      <div id="currentWeekLabel" class="sidebar-item active">Loading‚Ä¶</div>
    </div>

    <!-- Next Week -->
    <div class="sidebar-section">
      <div class="sidebar-header">Next Week</div>
      <div id="nextWeekLabel"></div>
    </div>

    <!-- Previous Weeks -->
    <div class="sidebar-section">
      <div class="sidebar-header">Previous Weeks</div>
      <div id="weeksList"></div>
    </div>

  </div>
</div>
    
  <!-- Main Content Wrapper -->
  <div id="mainContent" class="main-content">
  <!-- The Bigger Picture - Multi-Step Experience -->
  <div class="bigger-picture-experience" id="biggerPictureExp">
    
<!-- STEP 1 ‚Äî Vision Splash -->
<div class="bp-step active" id="step-vision">
  <div class="vision-collage-container">
    
    <!-- Pre-loading Screen with Pink Halo -->
    <div class="vision-pre-loading" id="visionPreLoading">
      <div class="vision-pre-content">
        <div class="vision-pre-halo"></div>
        <div class="vision-pre-text">Reflect on Your Vision</div>
      </div>
    </div>
    
    <!-- Vision Board Gallery -->
    <div class="vision-collage">
      <!-- Images loaded dynamically by JavaScript -->
    </div>

    <!-- Overlay - Bottom Right -->
    <div class="vision-overlay" id="visionOverlay">
      <div class="vision-date" id="visionDateRange">Loading‚Ä¶</div>
      <button class="vision-continue-btn" onclick="nextBPStep()">Continue ‚Üí</button>
    </div>

  </div>
</div>


<!-- Step 2: Yearly Milestones -->
<div class="bp-step" id="step-milestones">
  <div class="milestones-collage-container">
    
    <!-- Pre-loading Screen with Pink Halo -->
    <div class="milestones-pre-loading" id="milestonesPreLoading">
      <div class="milestones-pre-content">
        <div class="milestones-pre-halo"></div>
        <div class="milestones-pre-text">Reflect on 2025</div>
      </div>
    </div>
    
    <!-- Milestones Gallery (populated by JavaScript) -->
    <div class="milestones-collage" id="milestonesCollage">
      <!-- Floating image cards with overlays will be added here -->
    </div>

    <!-- Bottom Right Overlay -->
    <div class="milestones-bottom-overlay" id="milestonesOverlay">
      <button class="milestone-continue-btn" onclick="nextBPStep()">Continue to Sprint ‚Üí</button>
    </div>

  </div>
</div>

    <!-- Step 3: 6-Week Sprint Focus -->
    <div class="bp-step" id="step-sprint">
      <div class="sprint-container">
        <div class="sprint-header">
          <div class="sprint-badge">CURRENT SPRINT</div>
          <h2 class="sprint-title">Develop a Source of Income<br/>That is Aligned with Living a Life You Enjoy</h2>
          <div class="sprint-dates">Nov 16 - Dec 28, 2025 ‚Ä¢ 6 Weeks</div>
        </div>

        <div class="sprint-body">
          <!-- Key Milestones -->
          <div class="sprint-section">
            <div class="sprint-section-title">üéØ Key Milestones</div>
            <div class="sprint-milestones">
              <div class="sprint-milestone">
                <div class="milestone-number">1</div>
                <div class="milestone-text">Build useful automations and products for yourself</div>
              </div>
              <div class="sprint-milestone">
                <div class="milestone-number">2</div>
                <div class="milestone-text">Document learnings and process as your v1 offering to businesses</div>
              </div>
              <div class="sprint-milestone">
                <div class="milestone-number">3</div>
                <div class="milestone-text">Package automations into simple landing page and social media</div>
              </div>
              <div class="sprint-milestone">
                <div class="milestone-number">4</div>
                <div class="milestone-text">Start outreach for design partnerships (money-back guarantee)</div>
              </div>
              <div class="sprint-milestone">
                <div class="milestone-number">5</div>
                <div class="milestone-text">Ship and impress initial customers to get testimonials and referrals</div>
              </div>
            </div>
          </div>

          <!-- Weekly Commitments -->
          <div class="sprint-section">
            <div class="sprint-section-title">üíé Weekly Commitments</div>
            <div class="commitment-grid">
              <div class="commitment-card">
                <div class="commitment-icon">üè¶</div>
                <div class="commitment-title">Spend &lt;$150</div>
                <div class="commitment-details">
                  <div>‚Ä¢ Groceries & meal prep</div>
                  <div>‚Ä¢ Cafe spend &lt;$10</div>
                  <div>‚Ä¢ Dinner out 1x/week</div>
                </div>
              </div>
              <div class="commitment-card">
                <div class="commitment-icon">üå≥</div>
                <div class="commitment-title">Healthy Routines</div>
                <div class="commitment-details">
                  <div>‚Ä¢ Move body 2-3x/week</div>
                  <div>‚Ä¢ Morning routine daily</div>
                  <div>‚Ä¢ Sunday planning ritual</div>
                </div>
              </div>
              <div class="commitment-card">
                <div class="commitment-icon">üå∏</div>
                <div class="commitment-title">Trust the Process</div>
                <div class="commitment-details">
                  <div>‚Ä¢ One step at a time</div>
                  <div>‚Ä¢ Enjoy the journey</div>
                  <div>‚Ä¢ Reflect weekly</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Sprint Philosophy -->
          <div class="sprint-section">
            <div class="sprint-philosophy">
              <div class="philosophy-icon">‚ú®</div>
              <div class="philosophy-text">
                Take your time, like your Bali sabbatical but with work. Trust your intuition to go one step at a time. Focus on enjoying the process, gaining conviction in yourself and your offering. Small actions add up.
              </div>
            </div>
          </div>
        </div>

        <button class="sprint-begin-btn" onclick="closeBiggerPicture()">Begin Weekly Planning ‚Üí</button>
      </div>
    </div>

      <!-- Milestone Celebration Overlay -->
  <div class="celebration-overlay" id="celebrationOverlay">
    <div class="celebration-content">
      <div class="celebration-particles"></div>
      <div class="celebration-icon">üéâ</div>
      <div class="celebration-message" id="celebrationMessage">Milestone Achieved!</div>
      <div class="celebration-quote" id="celebrationQuote"></div>
    </div>
  </div>

  </div>


  <!-- Main Container -->
  <div class="main-container">
    <!-- Header -->
    <div class="header">
      <div class="progress-bar" id="progressBar"></div>
      <div class="progress-label">
        <span id="progressText">Part 1 of 6</span>
        <span id="sectionName">Reality Check</span>
      </div>
    </div>


      <!-- Main Content -->
      <div class="content-area" id="contentArea"></div>
      
    </div>
  </div>

  <script>

    

    // === LOAD CORRECT WEEK & FORMDATA (MUST RUN FIRST) ===

// 1. Load currentWeek
// Allow URL ?week=YYYY-MM-DD override
const urlParams = new URLSearchParams(window.location.search);
let currentWeek = urlParams.get("week") || localStorage.getItem("currentWeek");

// If STILL no currentWeek ‚Üí auto-detect
if (!currentWeek) {
  const today = new Date();
  const dow = today.getDay();
  const mondayOffset = dow === 0 ? -6 : 1 - dow;
  const monday = new Date(today);
  monday.setDate(today.getDate() + mondayOffset);
  currentWeek = monday.toISOString().split("T")[0];
}

localStorage.setItem("currentWeek", currentWeek);
console.log("üóìÔ∏è Current week:", currentWeek, formatWeekLabel(currentWeek));

// 3. Load the week data from localStorage
const weekKey = `week-${currentWeek}`;
let weekData = JSON.parse(localStorage.getItem(weekKey) || "{}");

// 4. Ensure the shape exists
if (!weekData.formData) {
  weekData.formData = {};
  // DO NOT SAVE YET ‚Äî wait until the user actually writes data
}

// 5. THIS is the real formData the questionnaire uses
let formData = weekData.formData;

console.log("üìÑ Loaded formData for", weekKey, formData);


  function getNextWeekDates() {
  const today = new Date();
  
  // Start = next Monday
  const day = today.getDay();
  const diff = today.getDate() + (1 + 7 - day) % 7;
  const nextMonday = new Date(today.setDate(diff));
  
  // End = following Sunday
  const nextSunday = new Date(nextMonday);
  nextSunday.setDate(nextMonday.getDate() + 6);

  const options = { month: "short", day: "numeric" };
  return `${nextMonday.toLocaleDateString("en-US", options)} ‚Äî ${nextSunday.toLocaleDateString("en-US", options)}`;
}

// Inject date range when page loads
document.addEventListener("DOMContentLoaded", () => {
  const el = document.getElementById("visionDateRange");
  if (el) {
    el.textContent = `Planning for: ${getNextWeekDates()}`;
  }
});
// ===== WEEK-BASED HELPER FUNCTIONS =====

function getCurrentWeekKey() {
  const today = new Date();
  const monday = getMonday(today);
  return formatDateKey(monday);
}

function getMonday(date) {
  const d = new Date(date);
  const day = d.getDay();
  const diff = d.getDate() - day + (day === 0 ? -6 : 1);
  return new Date(d.setDate(diff));
}

function formatDateKey(date) {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

function formatWeekLabel(weekKey) {
  if (!weekKey) return 'Invalid week';

  // Normalize: accept "YYYY-MM-DD" or "week-YYYY-MM-DD"
  const dateString = weekKey.startsWith('week-') ? weekKey.substring(5) : weekKey;

  const [year, month, day] = dateString.split('-').map(Number);
  if (!year || !month || !day) return 'Invalid date';

  const start = new Date(year, month - 1, day);
  if (isNaN(start.getTime())) return 'Invalid date';

  const end = new Date(start);
  end.setDate(start.getDate() + 6);

  const options = { month: 'short', day: 'numeric' };
  const startLabel = start.toLocaleDateString(undefined, options);
  const endLabel = end.toLocaleDateString(undefined, options);

  return `${startLabel} ‚Äì ${endLabel}`;
}


function getAllWeeks() {
  const weeks = [];

  for (let i = 0; i < localStorage.length; i++) {
    const key = localStorage.key(i);

    // Strict detection of week keys
    if (typeof key === "string" && key.startsWith("week-")) {
      const dateStr = key.substring(5);

      // Only accept valid YYYY-MM-DD patterns
      if (/^\d{4}-\d{2}-\d{2}$/.test(dateStr)) {
        weeks.push(dateStr);
      }
    }
  }

  // Sort descending (newest first)
  return weeks.sort((a, b) => new Date(b) - new Date(a));
}




    // Yearly goals data
    // ============================================
// ENHANCED MILESTONES - JAVASCRIPT
// ============================================
// MILESTONES - EXACT VISION BOARD JAVASCRIPT
// Replace your milestone JavaScript section
// ============================================

// Yearly goals with images
const yearlyGoals = [
  // COMPLETED GOALS
  { name: "Move to New York City", completed: true, image: "nyc.jpg" },
  { name: "Survive Break Up", completed: true, image: "survive-breakup.jpg" },
  { name: "Wind Down the Business", completed: true, image: "business-shutdown.jpg" },
  { name: "Pay Off Credit Card Debt", completed: true, image: "ccdebt.jpg" },
  { name: "Design Dream Identity", completed: true, image: "dreamidentity.jpg" },
  { name: "Lose 10 Pounds", completed: true, image: "lose10lbs.jpg" },
  { name: "Get New Job", completed: true, image: "job.jpg" },
  { name: "Set Up Personal Space", completed: true, image: "peace.jpg" },
  
  // TO COME GOALS
  { name: "Design Dream Life", completed: false, image: "dream-life.jpg" },
  { name: "Develop Daily Routines", completed: false, image: "routine-real.jpg" },
  { name: "Go to Bali", completed: false, image: "bali.jpg" },
  { name: "Learn How to Code", completed: false, image: "learntocode.jpg" },
  { name: "Learn How to DJ", completed: false, image: "dj.jpg" },
  { name: "Personal Website", completed: false, image: "portfolio.jpg" },
  { name: "Post Daily on Socials", completed: false, image: "socialmedia.jpg" }
];

// Load saved completion state from localStorage
function loadMilestonesState() {
  const savedGoals = localStorage.getItem('yearlyGoalsCompletion');
  if (savedGoals) {
    const completedNames = JSON.parse(savedGoals);
    yearlyGoals.forEach(goal => {
      if (completedNames.includes(goal.name)) {
        goal.completed = true;
      }
    });
  }
}

// Initialize milestones (called from nextBPStep when currentBPStep === 1)
function initMilestones() {
  const collageContainer = document.getElementById('milestonesCollage');
  const preLoading = document.getElementById('milestonesPreLoading');
  const overlay = document.getElementById('milestonesOverlay');
  
  if (!collageContainer) {
    console.log('Milestones collage container not found');
    return;
  }
  
  // Load saved state
  loadMilestonesState();
  
  // Clear any existing content
  collageContainer.innerHTML = '';
  
  // ========================================
  // PHASE 1: Show Pre-loading Screen (2 seconds)
  // ========================================
  setTimeout(() => {
    // Hide pre-loading screen
    if (preLoading) {
      preLoading.classList.add('hidden');
    }
    
    // ========================================
    // PHASE 2: Load Milestone Images Progressively
    // ========================================
    yearlyGoals.forEach((goal, index) => {
      // Create milestone image div
      const imgDiv = document.createElement('div');
      imgDiv.className = 'milestone-img';
      if (goal.completed) imgDiv.classList.add('completed');
      imgDiv.style.backgroundImage = `url('${goal.image}')`;
      imgDiv.dataset.index = index;
      
      // Create overlay with checkbox and text
      const overlayDiv = document.createElement('div');
      overlayDiv.className = 'milestone-overlay';
      overlayDiv.innerHTML = `
        <input type="checkbox" 
               class="milestone-checkbox" 
               ${goal.completed ? 'checked' : ''} 
               data-index="${index}" />
        <span class="milestone-label">${goal.name}</span>
      `;
      
      imgDiv.appendChild(overlayDiv);
      collageContainer.appendChild(imgDiv);
      
      // Stagger animation - each image appears 350ms after previous
      setTimeout(() => {
        imgDiv.classList.add('loaded');
      }, index * 350);
    });
    
    // Add click handlers to checkboxes
    setTimeout(() => {
      document.querySelectorAll('.milestone-checkbox').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
          const index = parseInt(e.target.dataset.index);
          toggleMilestoneCompletion(index);
        });
      });
      
      // Also allow clicking the whole card
      document.querySelectorAll('.milestone-img').forEach(img => {
        img.addEventListener('click', (e) => {
          if (e.target.classList.contains('milestone-checkbox')) return;
          const index = parseInt(img.dataset.index);
          const checkbox = img.querySelector('.milestone-checkbox');
          checkbox.checked = !checkbox.checked;
          toggleMilestoneCompletion(index);
        });
      });
    }, 100);
    
    // ========================================
    // PHASE 3: Show Button After All Images Load
    // ========================================
    const totalAnimationTime = yearlyGoals.length * 350 + 1000;
    setTimeout(() => {
      if (overlay) {
        overlay.classList.add('visible');
      }
    }, totalAnimationTime);
    
  }, 2000); // 2 seconds for pre-loading screen
  
  console.log('‚ú® Milestones initialized with', yearlyGoals.length, 'goals');
}

// Toggle milestone completion
function toggleMilestoneCompletion(index) {
  const wasCompleted = yearlyGoals[index].completed;
  yearlyGoals[index].completed = !yearlyGoals[index].completed;
  
  // Save to localStorage
  const completedGoals = yearlyGoals.filter(g => g.completed).map(g => g.name);
  localStorage.setItem('yearlyGoalsCompletion', JSON.stringify(completedGoals));
  
  // Update UI
  const imgDiv = document.querySelector(`.milestone-img[data-index="${index}"]`);
  if (imgDiv) {
    if (yearlyGoals[index].completed) {
      imgDiv.classList.add('completed');
    } else {
      imgDiv.classList.remove('completed');
    }
  }
  
  // If newly completed, show celebration
  if (!wasCompleted && yearlyGoals[index].completed) {
    showCelebration(yearlyGoals[index].name);
  }
}

// Show celebration overlay (reuse existing celebration overlay from your code)
function showCelebration(goalName) {
  const overlay = document.getElementById('celebrationOverlay');
  const message = document.getElementById('celebrationMessage');
  const quote = document.getElementById('celebrationQuote');
  
  if (!overlay || !message || !quote) return;
  
  message.textContent = goalName + ' ‚úì';
  quote.textContent = celebrationQuotes[Math.floor(Math.random() * celebrationQuotes.length)];
  
  overlay.classList.add('active');
  
  // Auto-hide after 3 seconds
  setTimeout(() => {
    overlay.classList.remove('active');
  }, 3000);
}

// Celebration quotes
const celebrationQuotes = [
  "You did not just complete a goal. You became the person who could.",
  "This moment. This milestone. You earned every bit of it.",
  "Look how far you have come. Look who you have become.",
  "Every victory starts with the decision to try. You did more than try.",
  "This is what happens when you refuse to give up on yourself.",
  "You are not the same person who set this goal. You are better.",
  "Remember when this felt impossible? Look at you now.",
  "This is evidence. Evidence that you can do hard things."
];



    let currentBPStep = 0;
    const bpSteps = ['step-vision', 'step-milestones', 'step-sprint'];

    // Data structures
    const sections = [
      { id: 'reality', name: "Reality Check" },
      { id: 'breakthroughs', name: "Breakthroughs" },
      { id: 'challenges', name: "Challenges" },
      { id: 'vision', name: "Vision" },
      { id: 'execution', name: "Execution" },
      { id: 'integration', name: "Integration" }
    ];

    const sectionContent = {
      reality: {
        title: "Reality Check",
        subtitle: "What happened last week ‚Äî and who was I being?",
        questions: [
          { type: 'goalsCheckoff' },
          { type: 'celebrationBanner' },
          { label: "What are 3-5 specific wins from last week?", sublabel: "Things you shipped, decisions you made, moments you're proud of", type: "textarea", placeholder: "Shipped feature X\nHad difficult conversation with Y\nMaintained meditation streak", id: "proudWins" },
          { label: "What patterns or behaviors gave you energy last week?", sublabel: "These become habits to repeat", type: "textarea", placeholder: "Working from cafe mornings\nNot checking phone first thing\nEvening walks", id: "whatWorked" },
          { type: 'kpis' },
          { label: "What pattern keeps showing up?", type: "textarea", placeholder: "What do you keep noticing?", id: "pattern" },
          { label: "What drained your energy last week?", type: "input", placeholder: "Activities, people, situations...", id: "whatDrained" },
          { label: "Energy baseline", type: "radio", options: ["Stable","Scattered","Creative","Low"], id: "energyBaseline" },
          { label: "Momentum score last week (0-10)", type: "slider", min: 0, max: 10, id: "momentumScore" }
        ]
      },
      breakthroughs: {
        title: "Breakthroughs + Intelligence",
        subtitle: "What did I learn? What's shifting inside me?",
        questions: [
          { label: "What was your biggest emotional breakthrough or shift?", sublabel: "One sentence", type: "textarea", placeholder: "I realized I don't need permission to...", id: "emotionalBreakthrough" },
          { label: "What was the biggest learning or surprise?", type: "textarea", placeholder: "What clicked? What became clear?", id: "biggestLearning" },
          { label: "What's your biggest fear right now?", type: "textarea", placeholder: "What are you most afraid of?", id: "biggestFear" },
          { label: "Any fear or scarcity mindset to clear?", type: "textarea", placeholder: "What limiting belief needs to go?", id: "fearMindset" },
          { label: "Anything to release before next week?", type: "textarea", placeholder: "What do you need to let go of?", id: "toRelease" }
        ],
        pause: "‚è∏Ô∏è Close your eyes. Take three deep breaths. Feel yourself releasing what no longer serves you. You're making space for what's next."
      },
      challenges: {
        title: "Challenges + Corrections",
        subtitle: "Problems are not bad ‚Äî they're data.",
        questions: [
          { label: "How was your eating last week?", type: "toggle", id: "challengeEating" },
          { label: "How did your routines feel?", sublabel: "Morning, movement, sleep, deep work", type: "toggle", id: "challengeRoutines" },
          { label: "How was income and spending?", type: "toggle", id: "challengeIncome" },
          { label: "Did you abandon yourself at any moment?", sublabel: "Did you betray your own needs/boundaries?", type: "toggle", id: "challengeAbandon" }
        ],
        pause: "‚è∏Ô∏è These challenges don't define you ‚Äî they're just data. You're designing solutions right now."
      },
      vision: {
        title: "Vision + Direction",
        subtitle: "What am I building next week? Who am I becoming?",
        questions: [
          { type: 'contextDisplay' },
          { label: "Vision: If you're living your ideal life in 3 years, what does this week look like?", type: "textarea", placeholder: "Paint the picture...", id: "visionWeek" }
        ]
      },
      execution: {
        title: "Execution Map",
        subtitle: "Your strategy for winning the week.",
        questions: [
          { label: "The ONE big move", sublabel: "What is the one thing you can do such that by doing it, everything else will be easier or unnecessary?", type: "input", placeholder: "The single highest-impact priority this week...", id: "oneBigMove" },
          { label: "Work goals (3-5 max)", sublabel: "Toward your 6-week sprint milestone", type: "textarea", placeholder: "One goal per line...", id: "workGoals" },
          { label: "Life goals (3-5 max)", sublabel: "Include any auto-triggered goals from thresholds", type: "textarea", placeholder: "One goal per line...", id: "lifeGoals" },
          {label: "What 1‚Äì2 things will add joy or ease into my week?",
            sublabel: "Pick something small, beautiful, or comforting ‚Äî or add one from the dropdown below.",
            type: "textarea",
            placeholder: "Cafe morning\nSunset walk\nRooftop scening\nCreative hour‚Ä¶",
            id: "alivenessPlan"
            },
            { type: 'goalDisplay' },
          
        ],
        pause: "‚è∏Ô∏è Read your goals and upleveling plan out loud. Do they light you up? If not, go back and make them bigger."
      },
      integration: {
        title: "Integration",
        subtitle: "Final check before you launch into your week.",
        questions: [
          { label: "Excitement check: How excited am I for next week? (0-10)", type: "slider", min: 0, max: 10, id: "excitementCheck" }
        ],
        finalText: "üî• Read your One Big Move out loud.\n\nAsk yourself:\n\"Would the version of me living my dream life be proud of this week?\"\n\nIf yes ‚Üí Visualize Sunday night feeling accomplished.\nIf no ‚Üí Go back and make it bigger, more alive, more worthy of you."
      }
    };


    let currentSection = 'reality';
    let recommendedActions = [];
     let rerenderTimer = null;

    // Load saved data
    const savedData = localStorage.getItem('weeklyPlanData');
  if (savedData) {
    const parsed = JSON.parse(savedData);
    formData = parsed.formData || parsed;
  }
  

    // Load yearly goals completion state
    const savedYearlyGoals = localStorage.getItem('yearlyGoalsCompletion');
    if (savedYearlyGoals) {
      const completedGoals = JSON.parse(savedYearlyGoals);
      yearlyGoals.forEach(goal => {
        if (completedGoals.includes(goal.name)) {
          goal.completed = true;
        }
      });
    }

    // Load last week's goals
    const lastWeekData = localStorage.getItem('lastWeekGoals');
    if (lastWeekData) {
      const parsed = JSON.parse(lastWeekData);
      formData.lastWeekWorkGoals = parsed.workGoals || '';
      formData.lastWeekLifeGoals = parsed.lifeGoals || '';
    }

    // Bigger Picture step navigation
  function nextBPStep() {
  if (currentBPStep < bpSteps.length - 1) {
    document.getElementById(bpSteps[currentBPStep]).classList.remove('active');
    currentBPStep++;
    document.getElementById(bpSteps[currentBPStep]).classList.add('active');
    
    // Initialize milestones when reaching that step
    if (currentBPStep === 1) {
      initMilestones();  // ‚Üê CHANGE renderMilestones() TO initMilestones()
    }
  }
}

    function closeBiggerPicture() {
      document.getElementById('biggerPictureExp').style.display = 'none';
      document.body.style.overflow = 'auto';
      renderAll();
    }

    function showCelebration(goalName) {
      const overlay = document.getElementById('celebrationOverlay');
      const message = document.getElementById('celebrationMessage');
      const quote = document.getElementById('celebrationQuote');
      
      message.textContent = goalName + ' ‚úì';
      quote.textContent = celebrationQuotes[Math.floor(Math.random() * celebrationQuotes.length)];
      
      overlay.classList.add('active');
      
      // Add "just-completed" animation to the milestone
      setTimeout(() => {
        const milestoneItems = document.querySelectorAll('.milestone-item');
        const index = yearlyGoals.findIndex(g => g.name === goalName);
        if (milestoneItems[index]) {
          milestoneItems[index].classList.add('just-completed');
        }
      }, 100);
      
      // Auto-hide after 3 seconds
      setTimeout(() => {
        overlay.classList.remove('active');
      }, 3000);
      
      // Remove just-completed class after animation
      setTimeout(() => {
        const milestoneItems = document.querySelectorAll('.milestone-item');
        milestoneItems.forEach(item => item.classList.remove('just-completed'));
      }, 4000);
    }

    function safeRenderAll() {
  clearTimeout(rerenderTimer);
  rerenderTimer = setTimeout(() => {
    renderCurrentSection();
  }, 250);
}
    
    // Main render function
    function renderAll() {
      renderProgressBar();
      renderCurrentSection();
      updateRecommendedActions();
    }

    function renderProgressBar() {
      const currentIndex = sections.findIndex(s => s.id === currentSection);
      const progressBar = document.getElementById('progressBar');
      progressBar.innerHTML = sections.map((section, i) => {
        let className = 'progress-section';
        if (i < currentIndex) className += ' completed';
        if (i === currentIndex) className += ' current';
        return `<div class="${className}"></div>`;
      }).join('');
      
      document.getElementById('progressText').textContent = `Part ${currentIndex + 1} of ${sections.length}`;
      document.getElementById('sectionName').textContent = sections[currentIndex].name;
    }


    function navigateToSection(sectionId) {
      saveFormData();
      currentSection = sectionId;
      renderAll();
      window.scrollTo(0, 0);
    }

    function renderCurrentSection() {
      const content = sectionContent[currentSection];
      const contentArea = document.getElementById('contentArea');
      let html = '';

      // Section header
      html += `
        <div class="section-header">
          <div class="section-title">${content.title}</div>
          ${content.subtitle ? `<div class="section-subtitle">${content.subtitle}</div>` : ''}
        </div>
      `;

      // Questions
      content.questions.forEach(q => {
        html += renderQuestion(q);
      });

      // Pause card
      if (content.pause) {
        html += `<div class="pause-card">${content.pause}</div>`;
      }

      // Final text
      if (content.finalText) {
        html += `<div class="pause-card" style="white-space: pre-line;">${content.finalText}</div>`;
      }

      // Navigation
      const currentIndex = sections.findIndex(s => s.id === currentSection);
      html += `
        <div class="nav-footer">
          ${currentIndex > 0 ? `<button class="nav-btn" onclick="navigatePrevious()">‚Üê Previous</button>` : ''}
          ${currentIndex < sections.length - 1 ? 
            `<button class="nav-btn nav-btn-primary" onclick="navigateNext()">Next ‚Üí</button>` :
            `<button class="nav-btn nav-btn-primary" onclick="generateDashboard()">Generate Dashboard ‚Üí</button>`
          }
        </div>
      `;

      contentArea.innerHTML = html;
      attachEventListeners();
      attachToggleListeners(); 
    }

    function renderQuestion(q) {
      let html = '';

      // Special types
      if (q.type === 'goalsCheckoff') {
        return renderGoalsCheckoff();
      }
      if (q.type === 'celebrationBanner') {
        return `<div class="celebration-banner">‚è∏Ô∏è Take a breath. You're allowed to celebrate yourself.</div>`;
      }
      if (q.type === 'kpis') {
        return renderKPIs();
      }
      if (q.type === 'contextDisplay') {
        return renderContextDisplay();
    }
      if (q.type === 'goalDisplay') {
        return renderGoalDisplay();
      }

      html += `<div class="question-block">`;
      html += `<div class="question-label">${q.label}</div>`;
      if (q.sublabel) html += `<div class="question-sublabel">${q.sublabel}</div>`;

      const value = formData[q.id] || '';

      switch (q.type) {
     case 'input':
  html += `
    <input 
      type="text"
      class="input-field"
      id="${q.id}"
      name="${q.id}"
      placeholder="${q.placeholder || ''}"
      value="${value || ''}"
    />
  `;
  break;

        case 'toggle':
  const currentValue = formData[q.id] || 'good';
  html += `
    <div class="toggle-group" data-id="${q.id}">
      <button class="toggle-btn good ${currentValue === 'good' ? 'active' : ''}">‚úì Good</button>
      <button class="toggle-btn bad ${currentValue === 'bad' ? 'active' : ''}">‚úó Needs Work</button>
    </div>

    <div class="action-input-wrapper ${currentValue === 'bad' ? 'visible' : ''}" 
         id="${q.id}ActionWrapper">
      <div class="question-sublabel" style="margin-top: 15px;">‚Üí What will you do about this?</div>
      <input class="input-field"
             id="${q.id}Action"
             placeholder="Your action plan..."
             value="${formData[q.id + 'Action'] || ''}" />
    </div>
  `;
  break;

        case 'radio':
          html += `<div class="radio-group">`;
          q.options.forEach(opt => {
            const checked = value === opt ? 'checked' : '';
            html += `
              <label>
                <input type="radio" name="${q.id}" value="${opt}" ${checked} />
                <span class="radio-label">${opt}</span>
              </label>
            `;
          });
          html += `</div>`;
          break;
        case 'checkbox':
          html += `<div class="checkbox-group">`;
          q.options.forEach(opt => {
            const saved = formData[q.id] || [];
            const checked = saved.includes(opt) ? 'checked' : '';
            html += `
              <div class="checkbox-item">
                <input type="checkbox" name="${q.id}" value="${opt}" ${checked} />
                <span class="checkbox-label">${opt}</span>
              </div>
            `;
          });
          html += `</div>`;
          break;
   case 'slider':
  const sliderValue = (value !== undefined && value !== null) ? value : q.min;
  html += `
    <div class="slider-wrapper">
      <input 
        type="range" 
        min="${q.min}" 
        max="${q.max}" 
        value="${sliderValue}" 
        class="slider" 
        id="${q.id}" 
      />
      <div class="slider-value" id="${q.id}-value">${sliderValue}</div>
    </div>
  `;
  break;

          case 'textarea':
  html += `
    <textarea
      class="input-field"
      id="${q.id}"
      name="${q.id}"
      placeholder="${q.placeholder || ''}"
      style="min-height: 80px;"
    >${value || ''}</textarea>
  `;
  break;

      }

      html += `</div>`;
      return html;
    }

    function renderGoalsCheckoff() {
      const workGoals = (formData.lastWeekWorkGoals || '').split('\n').filter(g => g.trim());
      const lifeGoals = (formData.lastWeekLifeGoals || '').split('\n').filter(g => g.trim());
      const allGoals = [...workGoals, ...lifeGoals];
      const completedGoals = formData.completedGoals || [];

      if (allGoals.length === 0) {
        return `
          <div class="question-block">
            <div class="question-label">What were your work goals last week?</div>
            <div class="question-sublabel">3-5 goals</div>
            <textarea class="input-field" id="lastWeekWorkGoals" placeholder="One goal per line...">${formData.lastWeekWorkGoals || ''}</textarea>
          </div>
          <div class="question-block">
            <div class="question-label">What were your life goals last week?</div>
            <div class="question-sublabel">3-5 goals</div>
            <textarea class="input-field" id="lastWeekLifeGoals" placeholder="One goal per line...">${formData.lastWeekLifeGoals || ''}</textarea>
          </div>
        `;
      }

      let html = `
        <div class="question-block">
          <div class="question-label">Check off the goals you completed</div>
          <div class="question-sublabel">Celebrate each one as you check it! üéâ</div>
          <div class="goal-list">
      `;
      
      allGoals.forEach((goal, i) => {
        const isCompleted = completedGoals.includes(goal);
        html += `
          <div class="goal-item ${isCompleted ? 'completed' : ''}" onclick="toggleGoalCompletion(${i})">
            <input type="checkbox" class="goal-checkbox" ${isCompleted ? 'checked' : ''} onchange="event.stopPropagation()" />
            <span class="goal-text">${goal}</span>
            <span class="goal-celebration">üéâ</span>
          </div>
        `;
      });
      
      html += `</div></div>`;
      return html;
    }

    function renderKPIs() {
      const kpis = [
        { label: "Weight", id: "kpiWeight", type: "text" },
        { label: "GitHub Commits", id: "kpiGithub", type: "number" },
        { label: "Days Meditated", id: "kpiMeditation", type: "number" },
        { label: "Spending ($)", id: "kpiSpending", type: "number" },
        { label: "Exciting Moments", id: "kpiExcitement", type: "number" },
        { label: "Runway (weeks)", id: "kpiRunway", type: "number" }
      ];

      let html = `
        <div class="question-block">
          <div class="question-label">Last Week's Key Metrics</div>
          <div class="kpi-grid">
      `;
      
      kpis.forEach(kpi => {
        const value = formData[kpi.id] || '';
        html += `
          <div class="kpi-item">
            <div class="kpi-label">${kpi.label}</div>
            <input type="${kpi.type}" class="kpi-input" id="${kpi.id}" value="${value}" />
          </div>
        `;
      });
      
      html += `</div><div id="thresholdAlerts"></div></div>`;
      
      setTimeout(() => {
        const alerts = checkThresholds();
        if (alerts.length > 0) {
          document.getElementById('thresholdAlerts').innerHTML = 
            alerts.map(a => `<div class="threshold-alert">${a}</div>`).join('');
        }
      }, 100);
      
      return html;
    }

    function renderContextDisplay() {
      let html = `<div class="context-box">`;

      
      // Recommended actions
      if (recommendedActions.length > 0) {
        html += `<div class="context-section"><div class="context-title">‚ú® Recommended actions</div>`;
        recommendedActions.forEach(a => {
          html += `<div class="context-item"><strong>${a.label}:</strong> ${a.action}</div>`;
        });
        html += `</div>`;
      }
      
      // Uncompleted goals
      const workGoals = (formData.lastWeekWorkGoals || '').split('\n').filter(g => g.trim());
      const lifeGoals = (formData.lastWeekLifeGoals || '').split('\n').filter(g => g.trim());
      const allGoals = [...workGoals, ...lifeGoals];
      const completedGoals = formData.completedGoals || [];
      const uncompletedGoals = allGoals.filter(g => !completedGoals.includes(g));
      
      
      html += `</div>`;
      return html;
    }


    function renderGoalDisplay() {
      const workGoals = (formData.workGoals || '').split('\n').filter(g => g.trim());
      const lifeGoals = (formData.lifeGoals || '').split('\n').filter(g => g.trim());
      
      let html = `
        <div class="goal-summary">
          <div class="goal-summary-title">üéØ Your Week at a Glance</div>
          <div class="goal-category">
            <div class="goal-category-title">One Big Move:</div>
            <div class="goal-display-item">${formData.oneBigMove || 'Not set'}</div>
          </div>
      `;
      
      if (workGoals.length > 0) {
        html += `<div class="goal-category"><div class="goal-category-title">Work Goals:</div>`;
        workGoals.forEach(g => html += `<div class="goal-display-item">${g}</div>`);
        html += `</div>`;
      }
      
      if (lifeGoals.length > 0) {
        html += `<div class="goal-category"><div class="goal-category-title">Life Goals:</div>`;
        lifeGoals.forEach(g => html += `<div class="goal-display-item">${g}</div>`);
        html += `</div>`;
      }
      
      html += `</div>`;
      return html;
    }

    function checkThresholds() {
      const alerts = [];
      if (parseInt(formData.kpiGithub) < 3) alerts.push("‚ö†Ô∏è GitHub commits <3 ‚Üí Add 'increase commits' to work goals");
      if (parseInt(formData.kpiMeditation) < 7) alerts.push("‚ö†Ô∏è Meditation <7 days ‚Üí Add 'daily meditation' to life goals");
      if (parseFloat(formData.kpiSpending) > 200) alerts.push("‚ö†Ô∏è Spending >$200 ‚Üí Add 'spending under $200' goal");
      if (parseInt(formData.kpiExcitement) === 0) alerts.push("‚ö†Ô∏è No excitement ‚Üí Add 'create excitement' goal");
      return alerts;
    }

    function updateRecommendedActions() {
      recommendedActions = [];
updateRecommendedActions._seen = new Set();

function pushUnique(label, action) {
  const key = `${label}||${action}`.trim().toLowerCase();
  if (updateRecommendedActions._seen.has(key)) return;  // skip duplicates
  updateRecommendedActions._seen.add(key);
  recommendedActions.push({ label, action });
}
      
      // From what worked
    if (formData.whatWorked) {
  formData.whatWorked
    .split('\n')
    .filter(l => l.trim())
    .forEach(line => {
      pushUnique("Continue Doing", line);
    });
}
      
      // From challenges
      const challenges = [
        { key: 'challengeEating', label: 'Eating' },
        { key: 'challengeRoutines', label: 'Routines' },
        { key: 'challengeIncome', label: 'Income' },
        { key: 'challengeAbandon', label: 'Self-Care' }
      ];
challenges.forEach(c => {
  if (formData[c.key] === 'bad' && formData[c.key + 'Action']) {
    pushUnique(c.label + ' Fix', formData[c.key + 'Action']);
  }
});
      
      // From uncompleted goals
      const workGoals = (formData.lastWeekWorkGoals || '').split('\n').filter(g => g.trim());
      const lifeGoals = (formData.lastWeekLifeGoals || '').split('\n').filter(g => g.trim());
      const allGoals = [...workGoals, ...lifeGoals];
      const completedGoals = formData.completedGoals || [];
     allGoals
  .filter(g => !completedGoals.includes(g))
  .forEach(goal => {
    pushUnique("Carry Forward", goal);
  });
      
      // From thresholds
    checkThresholds().forEach(alert => {
  pushUnique("Threshold Alert", alert.replace('‚ö†Ô∏è', '').trim());
});
      console.log("FINAL RECOMMENDED ACTIONS", recommendedActions);

      // Show recommended actions after challenges section
      const currentIndex = sections.findIndex(s => s.id === currentSection);
      if (currentIndex >= 2 && recommendedActions.length > 0) {
        const container = document.getElementById('recommendedActions');
        container.style.display = 'block';
        document.getElementById('recommendedContent').innerHTML = recommendedActions.map(a => `
          <div class="recommended-item">
            <div class="recommended-label">${a.label}</div>
            ${a.action}
          </div>
        `).join('');
      } else {
        document.getElementById('recommendedActions').style.display = 'none';
      }
    }

    function toggleGoalCompletion(index) {
      const workGoals = (formData.lastWeekWorkGoals || '').split('\n').filter(g => g.trim());
      const lifeGoals = (formData.lastWeekLifeGoals || '').split('\n').filter(g => g.trim());
      const allGoals = [...workGoals, ...lifeGoals];
      const goal = allGoals[index];
      
      if (!formData.completedGoals) formData.completedGoals = [];
      const idx = formData.completedGoals.indexOf(goal);
      if (idx > -1) {
        formData.completedGoals.splice(idx, 1);
      } else {
        formData.completedGoals.push(goal);
      }
      
      saveFormData();
      safeRenderAll();
    }

    // ===== TOGGLE HANDLER =====
function setToggle(id, value) {
  formData[id] = value;
  saveFormData();
  updateRecommendedActions();
}

// ===== INPUT + UI EVENT LISTENERS =====
function attachEventListeners() {

  // =============================
  // 1. Auto-save for all TEXT INPUTS
  // =============================
  document.querySelectorAll('input.input-field').forEach(input => {
    input.addEventListener("input", () => {
      formData[input.id] = input.value;
      saveFormData();
    });
  });

  // =============================
  // 2. Auto-save for TEXTAREAS
  // (if you ever add them later)
  // =============================
  document.querySelectorAll('textarea').forEach(area => {
    area.addEventListener("input", () => {
      formData[area.id] = area.value;
      saveFormData();
    });
  });

  // =============================
  // 3. CHECKBOXES
  // =============================
  document.querySelectorAll('.checkbox-group input[type="checkbox"]').forEach(box => {
    box.addEventListener("change", () => {
      const id = box.name;
      const selected = [...document.querySelectorAll(`input[name="${id}"]:checked`)]
        .map(b => b.value);
      formData[id] = selected;
      saveFormData();
    });
  });

  // =============================
  // 4. RADIO GROUPS
  // =============================
  document.querySelectorAll('.radio-group input[type="radio"]').forEach(radio => {
    radio.addEventListener("change", () => {
      formData[radio.name] = radio.value;
      saveFormData();
    });
  });

  // =============================
  // 5. SLIDERS
  // =============================
  document.querySelectorAll('input.slider').forEach(slider => {
  slider.addEventListener("input", () => {
    const id = slider.id;
    const val = slider.value;

    // Save live slider value
    formData[id] = val;
    saveFormData();

    // Update the display number
    const label = document.getElementById(`${id}-value`);
    if (label) label.textContent = val;
  });
});
}


// ===== FIX TOGGLE BUTTONS =====
function attachToggleListeners() {
  // Toggle buttons
  document.querySelectorAll('.toggle-group').forEach(group => {
    const id = group.getAttribute('data-id');

    group.querySelectorAll('.toggle-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const value = btn.classList.contains('good') ? 'good' : 'bad';

        // Save selection
        formData[id] = value;
        saveFormData();

        // Update button UI
        group.querySelectorAll('.toggle-btn')
             .forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Show/hide action input
        const wrapper = document.getElementById(id + 'ActionWrapper');
        if (wrapper) wrapper.classList.toggle('visible', value === 'bad');
      });
    });
  });

  // Auto-save for toggle action fields (challengeEatingAction, etc.)
  document.querySelectorAll('input[id$="Action"]').forEach(el => {
    el.addEventListener("input", () => {
      formData[el.id] = el.value.trim();
      saveFormData();
    });
  });


}

function addJoy(option) {
  const field = document.getElementById('alivenessPlan');
  if (!field) return;

  let current = field.value.trim();
  const appendText = current ? `${current}\n${option}` : option;

  field.value = appendText;

  // Update formData + save
  formData['alivenessPlan'] = appendText;
  saveFormData();
}

  

 // ===== UNIVERSAL SAVE ENGINE =====
function saveFormData() {
  console.log("Saving form data‚Ä¶");

  const newData = {};

  // 1Ô∏è‚É£ ‚Äî TEXT INPUTS + NUMBER INPUTS + TEXTAREAS
  document.querySelectorAll('#contentArea input[type="textarea"], #contentArea input[type="number"], #contentArea textarea')
    .forEach(el => {
      if (el.id) newData[el.id] = el.value.trim();
    });

  // 2Ô∏è‚É£ ‚Äî RADIO BUTTONS (use 'name', not ID)
  document.querySelectorAll('#contentArea input[type="radio"]').forEach(el => {
    if (el.checked) {
      if (el.name) newData[el.name] = el.value;
    }
  });

  // 3Ô∏è‚É£ ‚Äî CHECKBOX GROUPS
  const checkboxGroups = {};
  document.querySelectorAll('#contentArea input[type="checkbox"]').forEach(el => {
    const group = el.name || el.id;
    if (!checkboxGroups[group]) checkboxGroups[group] = [];
    if (el.checked) checkboxGroups[group].push(el.value);
  });
  Object.assign(newData, checkboxGroups);

  // 4Ô∏è‚É£ ‚Äî SLIDERS
  document.querySelectorAll('#contentArea input[type="range"]').forEach(el => {
    if (el.id) newData[el.id] = el.value;
  });

  // 5Ô∏è‚É£ ‚Äî TOGGLE ACTION FIELDS (challengeEatingAction)
  document.querySelectorAll('#contentArea input[id$="Action"]').forEach(el => {
    newData[el.id] = el.value.trim();

  

  });


  // 6Ô∏è‚É£ ‚Äî MERGE WITH EXISTING WEEK DATA
  const currentWeek = localStorage.getItem("currentWeek");
  const weekKey = `week-${currentWeek}`;
  let weekData = JSON.parse(localStorage.getItem(weekKey) || "{}");

  if (!weekData.formData) weekData.formData = {};

  weekData.formData = {
    ...weekData.formData, // existing persisted values
    ...formData,          // in-memory values
    ...newData            // latest user edits
  };

  // Update memory
  formData = weekData.formData;

  // Save to localStorage
  localStorage.setItem(weekKey, JSON.stringify(weekData));

  console.log("üíæ Saved:", weekData.formData);
}


    function navigateNext() {
      const currentIndex = sections.findIndex(s => s.id === currentSection);
      if (currentIndex < sections.length - 1) {
        saveFormData();
        currentSection = sections[currentIndex + 1].id;
        renderAll();
        window.scrollTo(0, 0);
      }
    }

    function navigatePrevious() {
      const currentIndex = sections.findIndex(s => s.id === currentSection);
      if (currentIndex > 0) {
        saveFormData();
        currentSection = sections[currentIndex - 1].id;
        renderAll();
        window.scrollTo(0, 0);
      }
    }

function generateDashboard() {
  saveFormData();

  const week = localStorage.getItem("currentWeek");

  // CLEAR the old dashboard state to force a fresh one
  localStorage.removeItem(`dashboardState-week-${week}`);

  window.location.href = 'dashboard.html';
}

    // Don't auto-render on load - wait for ritual

    function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const mainContent = document.getElementById('mainContent');

  if (sidebar.classList.contains('expanded')) {
    sidebar.classList.remove('expanded');
    sidebar.classList.add('collapsed');
    mainContent.classList.remove('sidebar-open');
  } else {
    sidebar.classList.add('expanded');
    sidebar.classList.remove('collapsed');
    mainContent.classList.add('sidebar-open');

    updateSidebarCurrentWeek();
    renderWeeksList();
    renderNextWeek();
  }
}



function renderWeeksList() {
  const weeksList = document.getElementById('weeksList');
  if (!weeksList) return;

  const allWeeks = getAllWeeks();
  const cw = localStorage.getItem('currentWeek');

  const previousWeeks = allWeeks
    .filter(w => new Date(w) < new Date(cw))
    .sort((a, b) => new Date(b) - new Date(a));

  if (previousWeeks.length === 0) {
    weeksList.innerHTML =
      '<div style="padding:20px;text-align:center;color:rgba(0,0,0,0.3);font-size:0.75rem;">No previous weeks yet</div>';
    return;
    console.log('No previous weeks found');
  }

  let html = '';
  previousWeeks.forEach(weekKey => {
    html += `
      <div class="week-item" onclick="switchToWeek('${weekKey}')">
        <span>${formatWeekLabel(weekKey)}</span>
      </div>
    `;
  });

  weeksList.innerHTML = html;
}

function getNextWeekKey() {
  const cw = localStorage.getItem('currentWeek');
  if (!cw) return null;

  // Normalize: allow "week-YYYY-MM-DD" or "YYYY-MM-DD"
  const dateString = cw.startsWith('week-') ? cw.substring(5) : cw;

  const [year, month, day] = dateString.split('-').map(Number);
  if (!year || !month || !day) return null;

  const d = new Date(year, month - 1, day);
  if (isNaN(d.getTime())) return null;

  // Add 7 days
  d.setDate(d.getDate() + 7);

  const yyyy = d.getFullYear();
  const mm = String(d.getMonth() + 1).padStart(2, '0');
  const dd = String(d.getDate()).padStart(2, '0');

  // We return "YYYY-MM-DD" because getAllWeeks() returns that
  return `${yyyy}-${mm}-${dd}`;
  console.log('getNextWeekKey recieved');
}


function renderNextWeek() {
  const nextWeekDiv = document.getElementById("nextWeekLabel");
  if (!nextWeekDiv) return;

  const nextWeekKey = getNextWeekKey();
  const allWeeks = getAllWeeks();

  console.log("üìå nextWeekKey =", nextWeekKey);
  console.log("üìå allWeeks =", allWeeks);
  console.log("üìå doesNextWeekExist =", allWeeks.includes(nextWeekKey));

  if (allWeeks.includes(nextWeekKey)) {
    const label = formatWeekLabel(nextWeekKey);
    console.log("üìå label =", label);

    nextWeekDiv.innerHTML = `
      <div class="week-item" onclick="switchToWeek('${nextWeekKey}')">
        <span>${label}</span>
      </div>
    `;
  } else {
    nextWeekDiv.innerHTML = `
      <div style="padding: 10px 20px; color: rgba(0,0,0,0.2); font-size: 0.75rem;">
        No next week yet
      </div>
    `;
      
  }
}


function updateSidebarCurrentWeek() {
  const cw = localStorage.getItem('currentWeek');
  const label = document.getElementById('currentWeekLabel');
  if (label && cw) {
    label.textContent = formatWeekLabel(cw);
  }
}

function switchToWeek(weekKey) {
  const confirmed = confirm(`Switch to week: ${formatWeekLabel(weekKey)}?`);
  if (confirmed) {

    // ‚úÖ AUTO-CREATE WEEK IF MISSING
    const storageKey = "week-" + weekKey;
    if (!localStorage.getItem(storageKey)) {
      localStorage.setItem(storageKey, JSON.stringify({ formData: {} }));
      console.log("üìå Auto-created missing week:", storageKey);
    }

    // Set the current week
    localStorage.setItem("currentWeek", weekKey);

    // Reset day when switching weeks
    localStorage.setItem("currentDay", "monday");

    // Reload
    location.reload();
  }
}


function closeSidebar() {
  const sidebar = document.getElementById('sidebar');
  const mainContent = document.getElementById('mainContent');
  sidebar.classList.remove('expanded');
  sidebar.classList.add('collapsed');
  mainContent.classList.remove('sidebar-open');
}


  </script>
  
  <script>
const visionImagePool = [
  "badass.jpg",
  "b.jpg",
  "stick-to-your-plan.jpg",
  "powerfulenergy.jpg",
  "goddess.jpg",
  "gold-flow.jpg",
  "goodthings.jpg",
  "pexels-photo-15448063.webp",
  "spirit.jpg",
];

function initVisionBoard() {
  const collageContainer = document.querySelector('.vision-collage');
  const preLoading = document.getElementById('visionPreLoading');
  const overlay = document.getElementById('visionOverlay');
  
  if (!collageContainer) {
    console.log('Vision collage container not found');
    return;
  }
  
  // Clear any existing content
  collageContainer.innerHTML = '';
  
  // ========================================
  // PHASE 1: Show Pre-loading Screen (2 seconds)
  // ========================================
  setTimeout(() => {
    // Hide pre-loading screen
    if (preLoading) {
      preLoading.classList.add('hidden');
    }
    
    // ========================================
    // PHASE 2: Load Images Progressively
    // ========================================
    visionImagePool.forEach((imageSrc, index) => {
      const imgDiv = document.createElement('div');
      imgDiv.className = 'collage-img';
      imgDiv.style.backgroundImage = `url('${imageSrc}')`;
      collageContainer.appendChild(imgDiv);
      
      // Stagger animation - each image appears 350ms after previous
      setTimeout(() => {
        imgDiv.classList.add('loaded');
      }, index * 350);
    });
    
    // ========================================
    // PHASE 3: Show Button After All Images Load
    // ========================================
    const totalAnimationTime = visionImagePool.length * 350 + 1000;
    setTimeout(() => {
      if (overlay) {
        overlay.classList.add('visible');
      }
    }, totalAnimationTime);
    
  }, 2000); // 2 seconds for pre-loading screen
  
  console.log('‚ú® Vision board initialized with', visionImagePool.length, 'images');
}

// Run initialization when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initVisionBoard);
} else {
  initVisionBoard();
}

</script>

  </div> <!-- Close mainContent -->
</body>

</body>
</html>